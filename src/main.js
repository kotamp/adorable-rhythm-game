// Generated by CoffeeScript 1.12.7
(function() {
  var appearAttr, countH, countW, disappearAttr, flyingCircle, flyingSpeed, flyingTime, height, inRange, margin, paper, radius, randomInRange, randomPositive, standartAttr, toCoords, width;

  paper = Snap("#paper");

  width = paper.node.clientWidth;

  height = paper.node.clientHeight;

  margin = 50;

  countH = 10;

  countW = 20;

  radius = 20;

  appearAttr = {
    r: 1
  };

  standartAttr = {
    r: 20
  };

  disappearAttr = {
    r: 40,
    "fill-opacity": 0
  };

  flyingCircle = {
    r: 20,
    stroke: "#bada55",
    strokeWidth: 5
  };

  flyingTime = 2000;

  flyingSpeed = 100;

  inRange = function(value) {
    return Math.random() * 2 * value - value;
  };

  randomInRange = function(value) {
    return inRange(value);
  };

  randomPositive = function(value) {
    return Math.random() * value;
  };

  toCoords = (function() {
    var inColumn, inRow, innerHeight, innerWidth;
    innerWidth = width - 2 * margin;
    innerHeight = height - 2 * margin;
    inRow = innerWidth / (countW - 1);
    inColumn = innerHeight / (countH - 1);
    return function(cellx, celly) {
      return [margin + cellx * inRow, margin + celly * inColumn];
    };
  })();

  (function() {
    var action, beginPosition, endPosition, i, j, k, pp, ref, results, shard;
    console.log(innerWidth, innerHeight);
    results = [];
    for (i = k = 0, ref = countW; 0 <= ref ? k < ref : k > ref; i = 0 <= ref ? ++k : --k) {
      results.push((function() {
        var l, ref1, results1;
        results1 = [];
        for (j = l = 0, ref1 = countH; 0 <= ref1 ? l < ref1 : l > ref1; j = 0 <= ref1 ? ++l : --l) {
          endPosition = toCoords(i, j);
          pp = paper.circle(endPosition[0], endPosition[1], 0).attr(appearAttr).animate(standartAttr, 400, mina.easeout);
          action = function(elem) {
            return elem.animate(disappearAttr, 500, mina.easeout);
          };
          beginPosition = [endPosition[0] + randomInRange(100), -randomPositive(200)];
          shard = paper.circle(inRange(50) - 50, c[1] + inRange(100), radius);
          shard.animate({
            cx: endPosition[0],
            cy: endPosition[1]
          }, flyingTime, mina.easeout, (function(elem) {
            return function() {
              return elem.remove();
            };
          })(shard));
          results1.push(setTimeout(action, Math.random() * 1000 + 2000, pp));
        }
        return results1;
      })());
    }
    return results;
  })();


  /*
  rect = paper.rect 100, 200, 300, 400
  Snap.animate [50, 100], [150, 200], (v) ->
    console.log v
    rect.attr(x: v[0], y: v[1])
  , 1000, mina.easein
   */

}).call(this);
